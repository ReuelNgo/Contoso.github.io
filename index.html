<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Contoso - Smart Home Solutions</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #f8f9fa;
    }
    header {
      background: #1e2a38;
      color: white;
      padding: 60px 0;
      text-align: center;
    }
    section {
      padding: 60px 20px;
    }
    .product-card {
      background: white;
      border-radius: 10px;
      box-shadow: 0 0 15px rgba(0,0,0,0.05);
      padding: 30px;
      transition: transform 0.3s ease;
    }
    .product-card:hover {
      transform: translateY(-5px);
    }
    footer {
      background-color: #1e2a38;
      color: white;
      text-align: center;
      padding: 30px;
      margin-top: 40px;
    }
  </style>
</head>
<body>

  <header>
    <h1 class="display-4">Welcome to Contoso</h1>
    <p class="lead">Smart Solutions for Smarter Living</p>
  </header>

  <section id="about" class="container">
    <h2 class="mb-4">About Us</h2>
    <p>Contoso is a leading innovator in the smart home industry, committed to creating intelligent, connected solutions that enhance the comfort, security, and efficiency of modern living. From individual households to smart apartment communities, we provide future-ready products that integrate seamlessly into your daily life.</p>

    <p class="mt-4"><strong>Our Mission:</strong> At Contoso, our mission is to transform homes into intelligent, responsive environments that simplify lives and save energy. We believe technology should empower people, not overwhelm them. That’s why we design user-friendly systems that adapt to you — providing peace of mind, convenience, and sustainability for everyone. Whether it’s through advanced AI monitoring, energy optimization, or integrated automation, our goal is to help you live smarter every day.</p>
  </section>

  <section id="products" class="container">
    <h2 class="mb-5">Our Products & Services</h2>
    <div class="row g-4">
      <div class="col-md-4">
        <div class="product-card p-4">
          <h4>Contoso Smart Hub</h4>
          <p>Manage all your smart devices with one intuitive hub that supports voice commands, automation, and over 300 integrations.</p>
        </div>
      </div>
      <div class="col-md-4">
        <div class="product-card p-4">
          <h4>AI Home Security</h4>
          <p>Facial recognition, motion alerts, cloud storage, and 24/7 intelligent surveillance to keep your home secure.</p>
        </div>
      </div>
      <div class="col-md-4">
        <div class="product-card p-4">
          <h4>EnergySmart Thermostats</h4>
          <p>Smart learning thermostats that reduce consumption while maintaining comfort — saving energy and money effortlessly.</p>
        </div>
      </div>
    </div>
  </section>
  <section class="container py-5">
  <h2 class="text-center mb-5">Why Choose Contoso?</h2>
  <div class="row text-center g-4">
    <div class="col-md-4">
      <i class="bi bi-lightning-charge" style="font-size: 2rem;"></i>
      <h5 class="mt-3">Fast Setup</h5>
      <p>Install and connect devices in under 30 minutes with our plug-and-play system.</p>
    </div>
    <div class="col-md-4">
      <i class="bi bi-shield-lock" style="font-size: 2rem;"></i>
      <h5 class="mt-3">Top Security</h5>
      <p>Enterprise-grade encryption and real-time alerts keep your data and home safe.</p>
    </div>
    <div class="col-md-4">
      <i class="bi bi-bar-chart" style="font-size: 2rem;"></i>
      <h5 class="mt-3">Smart Insights</h5>
      <p>Track energy usage and home patterns to optimize efficiency and savings.</p>
    </div>
  </div>
</section>

  <section id="testimonials" class="bg-light py-5">
  <div class="container">
    <h2 class="text-center mb-5">What Our Customers Say</h2>
    <div id="testimonialCarousel" class="carousel slide" data-bs-ride="carousel">
      <div class="carousel-inner">

        <div class="carousel-item active">
          <div class="text-center p-4">
            <blockquote class="blockquote">
              <p>"Contoso transformed my home. Their Smart Hub makes everything feel futuristic and easy to control!"</p>
            </blockquote>
            <footer class="blockquote-footer">Jenna R., Portland, OR</footer>
          </div>
        </div>

        <div class="carousel-item">
          <div class="text-center p-4">
            <blockquote class="blockquote">
              <p>"I feel so much safer knowing I have AI security watching over my home. Installation was fast and smooth."</p>
            </blockquote>
            <footer class="blockquote-footer">David L., Chicago, IL</footer>
          </div>
        </div>

        <div class="carousel-item">
          <div class="text-center p-4">
            <blockquote class="blockquote">
              <p>"Love the EnergySmart thermostat! It lowered my bill and still keeps the house comfortable year-round."</p>
            </blockquote>
            <footer class="blockquote-footer">Priya K., Austin, TX</footer>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<section id="contact" class="py-5 bg-white">
  <div class="container">
    <h2 class="text-center mb-4">Get in Touch</h2>
    <form class="row g-3">
      <div class="col-md-6">
        <input type="text" class="form-control" placeholder="Your Name" required>
      </div>
      <div class="col-md-6">
        <input type="email" class="form-control" placeholder="Your Email" required>
      </div>
      <div class="col-12">
        <textarea class="form-control" rows="5" placeholder="Your Message" required></textarea>
      </div>
      <div class="col-12 text-center">
        <button id="loginButton" type="submit" class="btn btn-primary mt-3">Login</button>
      </div>
    </form>
  </div>
  <!-- Place this near the end of <body>, just before </body> -->
<!-- Chat Button -->
<div id="chat-toggle">
  <img src="https://cdn-icons-png.flaticon.com/512/4712/4712027.png" alt="Chat" />
</div>

<!-- Chat Panel Container -->
<div id="chat-panel">
  <!-- Replace with your Copilot Studio embed code -->
  <iframe src="https://copilotstudio.microsoft.com/environments/10dc9795-0ee5-ede9-9b23-0d739c89ad87/bots/crdd8_polly/webchat?__version__=2" frameborder="0" style="width: 100%; height: 100%;"></iframe>
  <button id="chat-close">&times;</button>
</div>

<style>
  /* Chat button styling */
  #chat-toggle {
    position: fixed;
    bottom: 30px;
    right: 30px;
    width: 60px;
    height: 60px;
    background: #0069CA;
    border-radius: 50%;
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: transform 0.2s;
    z-index: 1001;
  }
  #chat-toggle:hover {
    transform: scale(1.1);
  }
  #chat-toggle img {
    width: 32px;
    height: 32px;
  }

  /* Chat panel container styling */
  #chat-panel {
    position: fixed;
    bottom: 100px;
    right: 30px;
    width: 350px;
    height: 500px;
    background: white;
    border-radius: 10px;
    box-shadow: 0 8px 24px rgba(0,0,0,0.2);
    overflow: hidden;
    transform: scale(0);
    transform-origin: bottom right;
    transition: transform 0.3s ease-out;
    z-index: 1000;
  }

  #chat-panel.active {
    transform: scale(1);
  }

  #chat-panel iframe {
    width: 100%;
    height: 100%;
    border: none;
  }

  #chat-close {
    position: absolute;
    top: 8px;
    right: 8px;
    background: rgba(0,0,0,0.4);
    border: none;
    color: white;
    font-size: 20px;
    width: 32px;
    height: 32px;
    border-radius: 50%;
    cursor: pointer;
  }
</style>

<script>

  // Initialize MSAL

const msalConfig = {
  auth: {
    clientId: "b23e4369-f02e-4d4d-8ebc-d4216a351fe3",
    authority: "https://login.microsoftonline.com/fac75216-7554-4d10-b3e2-27b6277bdf67",
    redirectUri: "http://localhost:3000",
  }
};

const msalInstance = new msal.PublicClientApplication(msalConfig);

await msalInstance.loginPopup({ scopes: ["https://<org>.crm.dynamics.com/.default"] });

const account = msalInstance.getAllAccounts()[0];
const response = await msalInstance.acquireTokenSilent({
  account,
  scopes: ["https://<org>.crm.dynamics.com/.default"]
});
console.log("Access token:", response.accessToken);

  const chatToggle = document.getElementById('chat-toggle');
  const chatPanel = document.getElementById('chat-panel');
  const chatClose = document.getElementById('chat-close');

  chatToggle.addEventListener('click', () => {
    chatPanel.classList.toggle('active');
  });

  chatClose.addEventListener('click', () => {
    chatPanel.classList.remove('active');
  });

  // Optional: close chatbot when clicking outside panel
  document.addEventListener('click', (e) => {
    if (chatPanel.classList.contains('active') &&
        !chatPanel.contains(e.target) &&
        !chatToggle.contains(e.target)) {
      chatPanel.classList.remove('active');
    }
  });
</script>

</section>





  <footer>
    <p>&copy; 2025 Contoso Inc. All rights reserved.</p>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
